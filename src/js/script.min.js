"use strict";window.addEventListener("DOMContentLoaded",()=>{function e(e){const t=document.querySelector(".goods__wrapper");let o=document.createElement("div");o.classList.add("row","align-items-start"),t.appendChild(o),e.forEach(e=>{let t=document.createElement("div"),n=document.createElement("div");n.classList.add("col-12","col-sm-6","col-lg-4","col-xl-3"),t.classList.add("goods__item"),t.innerHTML=`\n            <img class="goods__img" src="${e.url}" alt="phone">\n            <div class="goods__colors">Доступно цветов: 4</div>\n            <div class="goods__title">${e.title}</div>\n            <div class="goods__info">\n              <div class="goods__price">\n                  <span>${e.price}</span> грн/шт\n              </div>\n              <div class="goods__counter">\n                  <button id="minus" disabled="">\n                    <svg width="20" height="20" xmlns="http://www.w3.org/2000/svg"\n                    xmlns:xlink="http://www.w3.org/1999/xlink"\n                    viewBox="0 0 491.858 491.858" xml:space="preserve">\n                    <path d="M465.167,211.613H240.21H26.69c-8.424,0-26.69,\n                    11.439-26.69,34.316s18.267,34.316,26.69,34.316h213.52h224.959\n                      c8.421,0,26.689-11.439,26.689-34.316S473.59,211.613,465.167,211.613z"/>\n                    </svg>\n                  </button>\n                  <span>1</span>\n                  <button id="plus">\n                    <svg width="20" height="20" xmlns="http://www.w3.org/2000/svg"\n                    xmlns:xlink="http://www.w3.org/1999/xlink"\n                    viewBox="0 0 491.86 491.86" xml:space="preserve">\n                      <path d="M465.167,211.614H280.245V26.691c0-8.424-11.439-26.69-34.316-26.69s-34.316,\n                      18.267-34.316,26.69v184.924H26.69 C18.267,211.614,0,223.053,0,245.929s18.267,\n                      34.316,26.69,34.316h184.924v184.924c0,8.422,11.438,26.69,34.316,26.69 s34.316-18.268,\n                      34.316-26.69V280.245H465.17c8.422,0,26.69-11.438,26.69-34.316S473.59,211.614,465.167,211.614z"/>\n                    </svg>\n                  </button>\n              </div>\n              <div class="goods__total-price">\n                  <div>Сумма</div>\n                  <span>0</span> грн\n              </div>\n            </div>\n            <button class="goods__btn">Добавить в корзину</button>\n            <div class="goods__like">\n              <svg width="25" height="25" xmlns="http://www.w3.org/2000/svg"\n                  xmlns:svg="http://www.w3.org/2000/svg">\n                  <path\n                      d="m12.38012,6.63838c4.60578,-13.23323 22.65142,\n                      0 0,17.01416c-22.65142,-17.01416 -4.60578,-30.24739 0,-17.01416z" />\n              </svg>\n            </div>\n          `,n.appendChild(t),o.appendChild(n)})}const t=async(t,o)=>{await fetch(t).then(e=>e.json()).then(t=>e(t.goods)),o()};t("js/db.json",()=>{function e(e,t){e.style.display="block",document.body.style.overflow="hidden",t()}function t(e){e.style.display="none",document.body.style.overflow=""}function o(){x.forEach(e=>{if(e.setAttribute("data-title-full",e.textContent),!(e.textContent.length<=49)){const t=`${e.textContent.slice(0,49)}...`;e.textContent=t,e.setAttribute("data-title-short",t)}})}function n(e){C.style.display="block";let t=performance.now();requestAnimationFrame(function o(n){let l=(n-t)/e.duration;l>1&&(l=1);let r=e.timing(l);e.draw(r),l<1&&requestAnimationFrame(o)})}function l(e,t,o){let n=e.querySelectorAll(".goods__item");t.textContent=n.length,0==n.length?(o.style.display="block",L.setAttribute("disabled","")):L.removeAttribute("disabled")}function r(){const e=m.querySelectorAll(".goods__total-price > span");let t=0;e.forEach(e=>{t+=+e.textContent}),v.textContent=t}function s(){const e=m.querySelectorAll(".goods__item-remove");e.forEach(e=>{e.addEventListener("click",()=>{const t=e.parentElement,o=t.querySelector(".goods__title"),n=o.dataset.titleShort;x.forEach(e=>{if(e.textContent==n){let t=e.parentElement,o=t.querySelector(".goods__btn");o.removeAttribute("disabled"),o.textContent="Добавить в корзину"}}),t.remove(),l(m,q,A),r()})})}function i(){const e=m.querySelectorAll(".goods__counter");e.forEach(e=>{const t=e.querySelector("#plus"),o=e.querySelector("#minus"),n=e.querySelector("span");let l=1;t.addEventListener("click",()=>{n.textContent=++l,o.removeAttribute("disabled",""),9==l&&t.setAttribute("disabled",""),c()}),o.addEventListener("click",()=>{n.textContent=--l,t.removeAttribute("disabled",""),l<=1&&o.setAttribute("disabled",""),c()})})}function c(){const e=m.querySelectorAll(".goods__item");e.forEach(e=>{let t=e.querySelector(".goods__price > span"),o=e.querySelector(".goods__counter > span"),n=e.querySelector(".goods__total-price > span");n.textContent=t.textContent*o.textContent,r()})}function d(){const e=y.querySelectorAll(".goods__item-remove");e.forEach(e=>{e.addEventListener("click",()=>{let t=e.parentElement,o=t.querySelector(".goods__title"),n=o.dataset.titleShort;x.forEach(e=>{if(e.textContent==n){let t=e.parentElement,o=t.querySelector(".goods__like > svg");o.style.fill="none"}}),t.remove(),l(y,g,H)})})}function a(){b.forEach(e=>{const t=e.querySelector(".goods__title");e.addEventListener("mouseover",()=>{let e=t.dataset.titleFull;t.textContent=e}),e.addEventListener("mouseout",()=>{let e=t.dataset.titleShort;t.textContent=e})})}const u=document.querySelector(".cart"),_=document.querySelector(".like"),m=document.querySelector(".cart__wrapper"),y=document.querySelector(".like__wrapper"),v=document.querySelector(".cart__total > span"),g=document.querySelector(".like__count > span"),p=document.querySelector(".cart__close"),h=document.querySelector(".like__close"),S=document.querySelector("#cart"),f=document.querySelector("#like"),q=document.querySelector(".nav__badge"),b=document.querySelectorAll(".goods__item"),x=document.querySelectorAll(".goods__title"),E=document.querySelectorAll(".goods__btn"),w=document.querySelectorAll(".goods__like"),k=document.querySelectorAll(".goods__like > svg"),C=document.querySelector(".confirm"),L=document.querySelector(".cart__confirm"),A=m.querySelector(".empty"),H=y.querySelector(".empty");S.addEventListener("click",function(){e(u,s)}),f.addEventListener("click",function(){e(_,d)}),p.addEventListener("click",function(){t(u)}),h.addEventListener("click",function(){t(_)}),E.forEach((e,t)=>{e.addEventListener("click",()=>{let o=b[t].cloneNode(!0),s=o.querySelector(".goods__btn"),d=o.querySelector(".goods__like"),a=document.createElement("div");s.remove(),d.remove(),n({duration:1e3,timing:function(e){return e},draw:function(e){e>=0&&(C.style.opacity=`${-1*e+1}`,C.style.transform=`translateY(${150*e}px)`)}}),a.classList.add("goods__item-remove"),o.appendChild(a),a.innerHTML="&times;";const u=e.parentElement,_=u.querySelector(".goods__title"),y=_.dataset.titleFull;m.appendChild(o);let v=o.querySelector(".goods__title");v.textContent=y,A&&(A.style.display="none"),e.setAttribute("disabled",""),e.textContent="Товар в корзине",l(m,q,A),i(),c(),r()})}),o(),b.forEach(e=>{const t=e.querySelector(".goods__like");e.addEventListener("mouseover",()=>{t.style.visibility="visible"}),e.addEventListener("mouseout",()=>{t.style.visibility="hidden"})}),w.forEach((e,t)=>{let o=k[t];o.style.fill="none",e.addEventListener("mouseover",()=>{o.style.strokeOpacity="1",e.style.boxShadow="1px 1px 5px rgba(0, 0, 0, 0.4)"}),e.addEventListener("mouseout",()=>{o.style.strokeOpacity=".7",e.style.boxShadow="1px 1px 5px rgba(0, 0, 0, 0.2)"}),e.addEventListener("click",()=>{if(o.style.fill="none"==o.style.fill?"rgb(220, 62, 42)":"none","rgb(220, 62, 42)"==o.style.fill){let o=b[t].cloneNode(!0),n=o.querySelector(".goods__btn"),l=o.querySelector(".goods__like"),r=document.createElement("div");n.remove(),l.remove(),r.classList.add("goods__item-remove"),o.appendChild(r),r.innerHTML="&times;";const s=e.parentElement,i=s.querySelector(".goods__title"),c=i.dataset.titleShort;y.appendChild(o);let d=o.querySelector(".goods__title");d.textContent=c,H&&(H.style.display="none")}else{const t=y.querySelectorAll(".goods__item");t.forEach(t=>{const o=t.querySelector(".goods__title"),n=o.textContent,l=e.parentElement,r=l.querySelector(".goods__title"),s=r.dataset.titleShort;n==s&&t.remove()})}l(y,g,H)})}),L.addEventListener("click",()=>{let e=m.querySelectorAll(".goods__item");if(e.length>0){let o=+v.textContent;e.forEach(e=>{e.remove(),l(m,q,A)}),r(),t(u),E.forEach(e=>{e.removeAttribute("disabled"),e.textContent="Добавить в корзину"}),alert(`Ваш заказ на сумму ${o} грн оформлен.\nСпасибо!\n\nНаш оператор скоро свяжется с Вами.`)}}),document.documentElement.clientWidth>768&&a()})});
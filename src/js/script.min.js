"use strict";window.addEventListener("DOMContentLoaded",()=>{function e(e){const t=document.querySelector(".goods__wrapper");let o=document.createElement("div");o.classList.add("row","align-items-center"),t.appendChild(o),e.forEach(e=>{let t=document.createElement("div"),n=document.createElement("div");n.classList.add("col-12","col-sm-6","col-lg-4","col-xl-3"),t.classList.add("goods__item"),t.innerHTML=`\n            <img class="goods__img" src="${e.url}" alt="phone">\n            <div class="goods__colors">Доступно цветов: 4</div>\n            <div class="goods__title">${e.title}</div>\n            <div class="goods__price">\n                <span>${e.price}</span> грн/шт\n            </div>\n            <button class="goods__btn">Добавить в корзину</button>\n            <div class="goods__like">\n              <svg width="25" height="25" xmlns="http://www.w3.org/2000/svg"\n                  xmlns:svg="http://www.w3.org/2000/svg">\n                  <path\n                      d="m12.38012,6.63838c4.60578,-13.23323 22.65142,\n                      0 0,17.01416c-22.65142,-17.01416 -4.60578,-30.24739 0,-17.01416z" />\n              </svg>\n            </div>\n          `,n.appendChild(t),o.appendChild(n)})}const t=async(t,o)=>{await fetch(t).then(e=>e.json()).then(t=>e(t.goods)),o()};t("js/db.json",()=>{function e(e,t){e.style.display="block",document.body.style.overflow="hidden",t()}function t(e){e.style.display="none",document.body.style.overflow=""}function o(){S.forEach(e=>{if(!(e.textContent.length<=49)){const t=`${e.textContent.slice(0,49)}...`;e.textContent=t}})}function n(e){w.style.display="block";let t=performance.now();requestAnimationFrame(function o(n){let l=(n-t)/e.duration;l>1&&(l=1);let r=e.timing(l);e.draw(r),l<1&&requestAnimationFrame(o)})}function l(e,t,o){let n=e.querySelectorAll(".goods__item");t.textContent=n.length,0==n.length&&(o.style.display="block")}function r(){const e=document.querySelectorAll(".cart__wrapper > .goods__item > .goods__price > span");let t=0;e.forEach(e=>{t+=+e.textContent}),m.textContent=t}function c(){const e=a.querySelectorAll(".goods__item-remove");e.forEach(e=>{e.addEventListener("click",()=>{e.parentElement.remove(),l(a,f,L),r()})})}function i(){const e=u.querySelectorAll(".goods__item-remove");e.forEach(e=>{e.addEventListener("click",()=>{let t=e.parentElement,o=t.querySelector(".goods__title"),n=o.textContent;S.forEach(e=>{if(e.textContent==n){let t=e.parentElement,o=t.querySelector(".goods__like > svg");o.style.fill="none"}}),t.remove(),l(u,_,b)})})}const s=document.querySelector(".cart"),d=document.querySelector(".like"),a=document.querySelector(".cart__wrapper"),u=document.querySelector(".like__wrapper"),m=document.querySelector(".cart__total > span"),_=document.querySelector(".like__count > span"),y=document.querySelector(".cart__close"),p=document.querySelector(".like__close"),g=document.querySelector("#cart"),v=document.querySelector("#like"),f=document.querySelector(".nav__badge"),q=document.querySelectorAll(".goods__item"),S=document.querySelectorAll(".goods__title"),h=document.querySelectorAll(".goods__btn"),E=document.querySelectorAll(".goods__like"),k=document.querySelectorAll(".goods__like > svg"),w=document.querySelector(".confirm"),x=document.querySelector(".cart__confirm"),L=a.querySelector(".empty"),b=u.querySelector(".empty");g.addEventListener("click",function(){e(s,c)}),v.addEventListener("click",function(){e(d,i)}),y.addEventListener("click",function(){t(s)}),p.addEventListener("click",function(){t(d)}),h.forEach((e,t)=>{e.addEventListener("click",()=>{let e=q[t].cloneNode(!0),o=e.querySelector("button"),c=e.querySelector(".goods__like"),i=document.createElement("div");o.remove(),c.remove(),n({duration:1e3,timing:function(e){return e},draw:function(e){e>=0&&(w.style.opacity=`${-1*e+1}`,w.style.transform=`translateY(${150*e}px)`)}}),i.classList.add("goods__item-remove"),e.appendChild(i),i.innerHTML="&times;",a.appendChild(e),L&&(L.style.display="none"),l(a,f,L),r()})}),o(),q.forEach(e=>{const t=e.querySelector(".goods__like");e.addEventListener("mouseover",()=>{t.style.visibility="visible"}),e.addEventListener("mouseout",()=>{t.style.visibility="hidden"})}),E.forEach((e,t)=>{let o=k[t];o.style.fill="none",e.addEventListener("mouseover",()=>{o.style.strokeOpacity="1",e.style.boxShadow="1px 1px 5px rgba(0, 0, 0, 0.4)"}),e.addEventListener("mouseout",()=>{o.style.strokeOpacity=".7",e.style.boxShadow="1px 1px 5px rgba(0, 0, 0, 0.2)"}),e.addEventListener("click",()=>{if(o.style.fill="none"==o.style.fill?"rgb(220, 62, 42)":"none","rgb(220, 62, 42)"==o.style.fill){let e=q[t].cloneNode(!0),o=e.querySelector("button"),n=e.querySelector(".goods__like"),l=document.createElement("div");o.remove(),n.remove(),l.classList.add("goods__item-remove"),e.appendChild(l),l.innerHTML="&times;",u.appendChild(e),b&&(b.style.display="none")}else{const t=u.querySelectorAll(".goods__item");t.forEach(t=>{const o=t.querySelector(".goods__title"),n=o.textContent,l=e.parentElement,r=l.querySelector(".goods__title"),c=r.textContent;n==c&&t.remove()})}l(u,_,b)})}),x.addEventListener("click",()=>{let e=a.querySelectorAll(".goods__item");if(e.length>0){let o=+m.textContent;e.forEach(e=>{e.remove(),l(a,f,L)}),r(),t(s),alert(`Ваш заказ на сумму ${o} грн оформлен.\nСпасибо!\n\nНаш оператор скоро свяжется с Вами.`)}else alert("Добавьте хотя бы один продукт!")})})});